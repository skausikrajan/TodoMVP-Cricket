<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TodoMVP-Cricket</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #001f3f, #003366);
      color: white;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: orange;
    }
    .section {
      background: #003366;
      margin-bottom: 20px;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(255, 140, 0, 0.4);
    }
    .label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 8px;
      border: none;
    }
    button {
      padding: 10px 15px;
      background-color: orange;
      border: none;
      color: white;
      font-size: 1em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }
    .summary, .scoresheet {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: #002244;
      border-radius: 10px;
    }
    .animation-container {
      margin-top: 20px;
      text-align: center;
    }
    .shot-animation {
      width: 300px;
      height: 300px;
      margin: 0 auto;
      background-size: cover;
      background-repeat: no-repeat;
      display: none;
    }
    .task-list, .task-history {
      margin-top: 20px;
    }
    .task-item {
      background-color: #002244;
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
    }
    .task-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .status {
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>TodoMVP-Cricket</h1>

  <div class="section summary">
    <div>Wickets Remaining: <span id="wickets">10/10</span></div>
    <div>Over Progress: <span id="overProgress">12/20</span></div>
  </div>

  <div class="section">
    <h2>Game Plan</h2>
    <label class="label">New Delivery</label>
    <input type="text" id="taskName" placeholder="Ready to take a shot?" />

    <label class="label">Difficulty</label>
    <select id="difficulty" onchange="updateShots()">
      <option value="Easy">Easy (1 Run)</option>
      <option value="Intermediate">Intermediate (2 Runs)</option>
      <option value="Hard">Hard (4 Runs)</option>
      <option value="Expert">Expert (6 Runs)</option>
    </select>

    <label class="label">Shot Type</label>
    <select id="shotType"></select>

    <label class="label">Due Date</label>
    <input type="date" id="dueDate" />

    <label class="label">Estimated Time</label>
    <input type="time" id="targetTime" />

    <label class="label">Notes</label>
    <textarea id="notes" placeholder="Add your commentary here..."></textarea>

    <button onclick="takeStrike()">Take Strike</button>

    <div class="task-list" id="taskList">
      <h3>Live Task Tracker</h3>
    </div>
  </div>

  <div class="section scoresheet">
    <div>Total Runs: <span id="totalRunsDisplay">0</span></div>
    <div>Last Task: <span id="lastTask">None</span></div>
  </div>

  <div class="animation-container">
    <div id="shotAnimation" class="shot-animation"></div>
  </div>

  <div class="section task-history" id="taskHistory">
    <h2>üìú Task History</h2>
  </div>
</div>

<script>
const shotMap = {
  Easy: ["Forward Defense", "Backfoot Defense", "Tap Off Side"],
  Intermediate: ["Cut Shot", "Leg Glance", "Sweep Shot"],
  Hard: ["Cover Drive", "Upper Cut", "Lofted Drive"],
  Expert: ["Pull Shot", "Hook Shot", "Scoop Shot", "Ramp Shot", "Helicopter Shot", "Slog Shot", "No-look Shot"]
};

const shotImages = {
  "Helicopter Shot": "https://media.giphy.com/media/2gG6PmpOZ8Ivq/giphy.gif"
};

let tasks = [];
let totalRuns = 0;
let wicketsLeft = 10;

function updateShots() {
  const difficulty = document.getElementById("difficulty").value;
  const shotTypeSelect = document.getElementById("shotType");
  shotTypeSelect.innerHTML = "";
  shotMap[difficulty].forEach(shot => {
    const opt = document.createElement("option");
    opt.value = shot;
    opt.textContent = shot;
    shotTypeSelect.appendChild(opt);
  });
}

function getRuns(difficulty) {
  return { Easy: 1, Intermediate: 2, Hard: 4, Expert: 6 }[difficulty];
}

function updateScore(difficulty, success) {
  const runValue = getRuns(difficulty);
  totalRuns += success ? runValue : -runValue;
  document.getElementById("totalRunsDisplay").textContent = totalRuns;
}

function playShotAnimation(shotType) {
  const animation = document.getElementById("shotAnimation");
  animation.style.backgroundImage = `url(${shotImages[shotType] || ''})`;
  animation.style.display = 'block';
}

function takeStrike() {
  const taskName = document.getElementById("taskName").value;
  const difficulty = document.getElementById("difficulty").value;
  const shot = document.getElementById("shotType").value;
  const notes = document.getElementById("notes").value;
  const dateStr = document.getElementById("dueDate").value;
  const timeStr = document.getElementById("targetTime").value;

  if (!dateStr || !timeStr) {
    alert("üìÖ‚è∞ Please select both date and time for the deadline.");
    return;
  }

  const [y, m, d] = dateStr.split("-").map(Number);
  const [hour, minute] = timeStr.split(":" ).map(Number);
  const deadline = new Date(y, m - 1, d, hour, minute, 0);

  const task = { taskName, difficulty, shot, deadline, completed: false, failed: false, id: Date.now() };
  tasks.push(task);
  document.getElementById("lastTask").textContent = taskName;
  playShotAnimation(shot);
  renderTasks();
  countdown(task);
}

function countdown(task) {
  const interval = setInterval(() => {
    const now = new Date();
    const timeLeft = task.deadline - now;
    const elem = document.getElementById(`status-${task.id}`);
    const completeBtn = document.getElementById(`btn-${task.id}`);

    if (task.completed || task.failed) {
      clearInterval(interval);
      return;
    }

    if (timeLeft <= 0) {
      task.failed = true;
      updateScore(task.difficulty, false);
      wicketsLeft--;
      if (wicketsLeft < 0) wicketsLeft = 0;
      document.getElementById("wickets").textContent = `${wicketsLeft}/10`;
      elem.textContent = "‚ùå Failed";
      if (completeBtn) completeBtn.remove();
      appendToHistory(task, "‚ùå Failed");
      alert(`‚è∞ Time's up! You lost ${getRuns(task.difficulty)} runs for \"${task.taskName}\"`);
      clearInterval(interval);
      return;
    }

    const mins = Math.floor(timeLeft / 60000);
    const secs = Math.floor((timeLeft % 60000) / 1000);
    elem.textContent = `‚è≥ In Progress - ${mins}m ${secs}s left`;
  }, 1000);
}

function markAsCompleted(taskId) {
  const task = tasks.find(t => t.id === taskId);
  if (task && !task.completed && !task.failed) {
    task.completed = true;
    updateScore(task.difficulty, true);
    document.getElementById(`status-${taskId}`).textContent = "‚úÖ Completed";
    document.getElementById(`btn-${taskId}`).remove();
    appendToHistory(task, "‚úÖ Completed");
    alert(`üèè Nice shot! You scored ${getRuns(task.difficulty)} runs.`);
  }
}

function appendToHistory(task, result) {
  const history = document.getElementById("taskHistory");
  const p = document.createElement("p");
  p.textContent = `${result} - ${task.taskName} (${task.shot}) at ${new Date().toLocaleTimeString()}`;
  history.appendChild(p);
  tasks = tasks.filter(t => t.id !== task.id);
  renderTasks();
}

function renderTasks() {
  const taskList = document.getElementById("taskList");
  taskList.innerHTML = "<h3>Live Task Tracker</h3>";
  tasks.forEach(task => {
    const div = document.createElement("div");
    div.className = "task-item";
    div.innerHTML = `
      <div class="task-header">
        <span><strong>${task.taskName}</strong> (${task.shot})</span>
        <span class="status" id="status-${task.id}">‚è≥ In Progress</span>
      </div>
      <button id="btn-${task.id}" onclick="markAsCompleted(${task.id})">Complete</button>
    `;
    taskList.appendChild(div);
  });
}

window.onload = updateShots;
</script>
</body>
</html>
